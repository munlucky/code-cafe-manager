# Order ì‹¤í–‰ UI ë¶„ì„

## ğŸ“Œ ê°œìš”

`main-user-flow.md`ì—ì„œ **Order ì‹¤í–‰ ì´í›„ì˜ UI**ì— ëŒ€í•œ ìƒì„¸ ë¬¸ì„œê°€ ëˆ„ë½ë˜ì–´ ìˆìŒì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤. ì´ ë¬¸ì„œëŠ” Order ì‹¤í–‰ ì‹œ UIê°€ ì–´ë–»ê²Œ ë™ì‘í•˜ëŠ”ì§€ë¥¼ ë¶„ì„í•œ ê²°ê³¼ì…ë‹ˆë‹¤.

---

## 1. ë¶„ì„ ê²°ê³¼ ìš”ì•½

### 1.1 main-user-flow.mdì˜ ëˆ„ë½ ì‚¬í•­

í˜„ì¬ `main-user-flow.md`ëŠ” ë‹¤ìŒì„ ë‹¤ë£¨ê³  ìˆìŠµë‹ˆë‹¤:
- âœ… Cafe ë“±ë¡ íë¦„
- âœ… Order ìƒì„± + Worktree ìƒì„± íë¦„
- âœ… Workflow/Recipe ì‹¤í–‰ ì‹œí€€ìŠ¤ (ë°±ì—”ë“œ)
- âŒ **Order ì‹¤í–‰ ì¤‘/í›„ UI ì»´í¬ë„ŒíŠ¸** (ëˆ„ë½)
- âŒ **Stage ì§„í–‰ ìƒí™© í‘œì‹œ UI** (ëˆ„ë½)
- âŒ **í„°ë¯¸ë„ ì¶œë ¥ í‘œì‹œ UI** (ëˆ„ë½)
- âŒ **ì‚¬ìš©ì ì…ë ¥ ì²˜ë¦¬ UI** (ëˆ„ë½)

---

## 2. Order ì‹¤í–‰ UI ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°

```
Order ì‹¤í–‰ ì‹œ UI íë¦„
=====================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Orders View (KanbanBoard)                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ OrderCard   â”‚  â”‚ OrderCard   â”‚  â”‚ OrderCard   â”‚  ...         â”‚
â”‚  â”‚ (PENDING)   â”‚  â”‚ (RUNNING)   â”‚  â”‚ (COMPLETED) â”‚              â”‚
â”‚  â”‚ [Execute]   â”‚  â”‚ [Cancel]    â”‚  â”‚ [Delete]    â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                â”‚
          â–¼ click          â–¼ click
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      OrderModal (Dialog)                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Header: WorkflowName | Order ID | [Summary] [Timeline]    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Tab: Summary                                               â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚ OrderSummaryView                                     â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€ OrderStageProgressBar (ì§„í–‰ë¥  ë°”)                â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€ OrderStageProgress (Stage ë±ƒì§€)                  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€ User Input Section (ì…ë ¥ ëŒ€ê¸° ì‹œ)                â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚ Terminal Output (í•˜ë‹¨ ê³ ì •)                          â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€ ì‹¤ì‹œê°„ ì¶œë ¥ ìŠ¤íŠ¸ë¦¬ë°                             â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Tab: Timeline                                              â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚ OrderTimelineView                                    â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€ stage_start ì´ë²¤íŠ¸                              â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€ log ê·¸ë£¹ (ì ‘ì„ ìˆ˜ ìˆìŒ)                         â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€ stage_complete ì´ë²¤íŠ¸                           â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€ input ì´ë²¤íŠ¸ (ì‚¬ìš©ì ì…ë ¥)                      â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                    ë˜ëŠ”

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   OrderDetailView (Full Page)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚     Left Panel         â”‚         Right Panel              â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚ Order Info Card  â”‚  â”‚  â”‚   InteractiveTerminal      â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - Provider      â”‚  â”‚  â”‚   â”œâ”€ Output ì˜ì—­           â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - Created       â”‚  â”‚  â”‚   â”‚   (ìŠ¤íŠ¸ë¦¬ë° ì¶œë ¥)      â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - Started       â”‚  â”‚  â”‚   â”‚                        â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - Branch        â”‚  â”‚  â”‚   â””â”€ Input ì˜ì—­            â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚       [í…ìŠ¤íŠ¸ ì…ë ¥] [Send] â”‚  â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚  â”‚ Prompt Card      â”‚  â”‚                                  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                                  â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                                  â”‚  â”‚
â”‚  â”‚  â”‚ Variables Card   â”‚  â”‚                                  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                                  â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                                  â”‚  â”‚
â”‚  â”‚  â”‚ Stage Progress   â”‚  â”‚                                  â”‚  â”‚
â”‚  â”‚  â”‚  - ProgressBar   â”‚  â”‚                                  â”‚  â”‚
â”‚  â”‚  â”‚  - Stage Badges  â”‚  â”‚                                  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                                  â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                                  â”‚  â”‚
â”‚  â”‚  â”‚ Error Card       â”‚  â”‚                                  â”‚  â”‚
â”‚  â”‚  â”‚ (ì‹¤íŒ¨ ì‹œ)        â”‚  â”‚                                  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                                  â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                                  â”‚  â”‚
â”‚  â”‚  â”‚ Retry Options    â”‚  â”‚                                  â”‚  â”‚
â”‚  â”‚  â”‚ (ì‹¤íŒ¨ ì‹œ)        â”‚  â”‚                                  â”‚  â”‚
â”‚  â”‚  â”‚ [Retry] [Close]  â”‚  â”‚                                  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. ì»´í¬ë„ŒíŠ¸ë³„ ìƒì„¸ ê¸°ëŠ¥

### 3.1 OrderCard

> íŒŒì¼: `components/orders/OrderCard.tsx`

| ê¸°ëŠ¥ | ì„¤ëª… |
|------|------|
| **ìƒíƒœ í‘œì‹œ** | `StatusBadge`ë¡œ PENDING/RUNNING/COMPLETED/FAILED/CANCELLED í‘œì‹œ |
| **ì§„í–‰ë¥  í‘œì‹œ** | `OrderStageProgressBar`ë¡œ í˜„ì¬ ì§„í–‰ ìƒí™© ì‹œê°í™” |
| **Execute ë²„íŠ¼** | PENDING ìƒíƒœì—ì„œë§Œ í‘œì‹œ, Order ì‹¤í–‰ íŠ¸ë¦¬ê±° |
| **Cancel ë²„íŠ¼** | PENDING/RUNNING ìƒíƒœì—ì„œ Order ì·¨ì†Œ |
| **Delete ë²„íŠ¼** | COMPLETED/FAILED/CANCELLED ìƒíƒœì—ì„œ Order ì‚­ì œ |
| **í´ë¦­ ì´ë²¤íŠ¸** | ì¹´ë“œ í´ë¦­ ì‹œ `OrderModal` ë˜ëŠ” `OrderDetailView` ì—´ê¸° |

---

### 3.2 OrderStageProgress / OrderStageProgressBar

> íŒŒì¼: `components/order/OrderStageProgress.tsx`

#### StageStatus íƒ€ì…
```typescript
type StageStatus = 'pending' | 'running' | 'completed' | 'failed' | 'skipped';
```

#### OrderStageProgress (ë±ƒì§€ í˜•íƒœ)
- Stageë³„ ìƒíƒœ ì•„ì´ì½˜ (CheckCircle, Loader2, XCircle, Circle)
- í˜„ì¬ Stage í•˜ì´ë¼ì´íŠ¸ (ring-2 ring-coffee/30)
- Stage ê°„ ì—°ê²°ì„  í‘œì‹œ

#### OrderStageProgressBar (ì§„í–‰ë°” í˜•íƒœ)
| ìƒ‰ìƒ | ì˜ë¯¸ |
|------|------|
| ğŸŸ¢ Green | ì™„ë£Œëœ Stage |
| ğŸŸ  Coffee (Orange) | ì‹¤í–‰ ì¤‘ì¸ Stage |
| ğŸ”´ Red | ì‹¤íŒ¨í•œ Stage |

**ì§„í–‰ ìƒíƒœ ë©”ì‹œì§€ í˜•ì‹**:
- ì‹¤íŒ¨ ì‹œ: `"Stage X/N failed: {stageName}"`
- ì‹¤í–‰ ì¤‘: `"Stage X/N: {stageName}"`
- ì™„ë£Œ ì‹œ: `"All N stages completed"`
- ê¸°ë³¸: `"X/N completed"`

---

### 3.3 OrderModal

> íŒŒì¼: `components/orders/OrderModal.tsx`

**íƒ­ êµ¬ì¡°**:
1. **Summary** íƒ­: `OrderSummaryView` + Terminal Output
2. **Timeline** íƒ­: `OrderTimelineView`

**ì£¼ìš” ê¸°ëŠ¥**:
- ì‹¤ì‹œê°„ ë¡œê·¸ êµ¬ë… (`window.codecafe.order.onOutput`)
- íˆìŠ¤í† ë¦¬ ë¡œê·¸ ë¡œë“œ (`window.codecafe.getOrderLog`)
- ìë™ ìŠ¤í¬ë¡¤ (ìƒˆ ì¶œë ¥ ì‹œ)
- ì‚¬ìš©ì ì…ë ¥ ì „ì†¡ (RUNNING ìƒíƒœì—ì„œë§Œ)

---

### 3.4 OrderSummaryView

> íŒŒì¼: `components/orders/OrderSummaryView.tsx`

**êµ¬ì„± ìš”ì†Œ**:
1. **Pipeline Progress**: Stage ì§„í–‰ë¥  ë°” + ë±ƒì§€
2. **Awaiting Input Section** (ë…¸ë€ìƒ‰ ê°•ì¡°):
   - `awaitingInput.required === true`ì¼ ë•Œë§Œ í‘œì‹œ
   - âš ï¸ "Action Required" í—¤ë”
   - í”„ë¡¬í”„íŠ¸ ë©”ì‹œì§€ í‘œì‹œ
   - ì…ë ¥ í•„ë“œ + Send ë²„íŠ¼
3. **General Input Section** (RUNNING ìƒíƒœ):
   - ì‹¤í–‰ ì¤‘ ì–¸ì œë“  ë©”ì‹œì§€ ì „ì†¡ ê°€ëŠ¥
   - MessageSquare ì•„ì´ì½˜

---

### 3.5 OrderTimelineView

> íŒŒì¼: `components/orders/OrderTimelineView.tsx`

**ì´ë²¤íŠ¸ íƒ€ì…**:
```typescript
type TimelineEventType = 'stage_start' | 'stage_complete' | 'stage_fail' | 'log' | 'input' | 'system';
```

**ì´ë²¤íŠ¸ë³„ ì‹œê°í™”**:
| íƒ€ì… | ì•„ì´ì½˜ | ë°°ê²½ìƒ‰ |
|------|--------|--------|
| stage_start | â–¶ï¸ Play (Blue) | Blue 10% |
| stage_complete | âœ… CheckCircle (Green) | Green 10% |
| stage_fail | âŒ XCircle (Red) | Red 10% |
| input | ğŸ’¬ MessageSquare (Yellow) | Yellow 10% |
| system | ğŸ–¥ï¸ Terminal (Gray) | Gray |
| log | â­• Circle (Gray) | Gray |

**ë¡œê·¸ ê·¸ë£¹í™”**:
- ì—°ì†ëœ `log` ì´ë²¤íŠ¸ëŠ” ì ‘ì„ ìˆ˜ ìˆëŠ” ê·¸ë£¹ìœ¼ë¡œ í‘œì‹œ
- ê¸°ë³¸ 3ê°œê¹Œì§€ ë¯¸ë¦¬ë³´ê¸°
- "Show X more lines..." ë²„íŠ¼ìœ¼ë¡œ í™•ì¥

---

### 3.6 InteractiveTerminal

> íŒŒì¼: `components/order/InteractiveTerminal.tsx`

**ê¸°ëŠ¥**:
- ì‹¤ì‹œê°„ ì¶œë ¥ ìŠ¤íŠ¸ë¦¬ë° í‘œì‹œ
- ANSI escape ì½”ë“œ ì²˜ë¦¬/ì œê±°
- ì¶œë ¥ íƒ€ì…ë³„ ìƒ‰ìƒ êµ¬ë¶„:
  - stdout: Gray
  - stderr: Red
  - system: Blue
  - user-input: Coffee (Orange)
- ìë™ ìŠ¤í¬ë¡¤ (í† ê¸€ ê°€ëŠ¥)
- ëª…ë ¹ì–´ íˆìŠ¤í† ë¦¬ (â†‘/â†“ í™”ì‚´í‘œ)
- ì…ë ¥ í•„ë“œ + Send ë²„íŠ¼ (RUNNING ìƒíƒœì—ì„œë§Œ)

---

### 3.7 OrderDetailView (Full Page)

> íŒŒì¼: `components/order/OrderDetailView.tsx`

**ë ˆì´ì•„ì›ƒ**:
- **Left Panel** (320px): Order ì •ë³´, Prompt, Variables, Stage Progress, Error, Retry Options
- **Right Panel** (flex-1): InteractiveTerminal

**ì£¼ìš” ê¸°ëŠ¥**:

1. **ì‹¤ì‹œê°„ Order ìƒíƒœ ê°±ì‹ **:
   - 3ì´ˆ ê°„ê²© í´ë§ (`ORDER_REFRESH_INTERVAL_MS`)
   
2. **ì‹¤ì‹œê°„ Stage ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ**:
   - `onStageStarted`: currentStageIndex ì—…ë°ì´íŠ¸
   - `onStageCompleted`: completedStages Setì— ì¶”ê°€
   
3. **Retry Options** (FAILED ìƒíƒœ):
   - "íŠ¹ì • Stageë¶€í„°" ì¬ì‹œë„
   - "ì²˜ìŒë¶€í„° (ì»¨í…ìŠ¤íŠ¸ ìœ ì§€)" ì¬ì‹œë„
   - Stage ì„ íƒ ë“œë¡­ë‹¤ìš´

---

### 3.8 TerminalOutputPanel

> íŒŒì¼: `components/terminal/TerminalOutputPanel.tsx`

**ìƒíƒœ í‘œì‹œ**:
```typescript
type OutputStatus = 'initializing' | 'ready' | 'running' | 'completed' | 'failed';
```

**ê¸°ëŠ¥**:
- êµ¬ë… ê¸°ë°˜ ì¶œë ¥ ìŠ¤íŠ¸ë¦¬ë° (`subscribeOutput`/`unsubscribeOutput`)
- ì¶œë ¥ ìƒíƒœ í‘œì‹œ (Initializing/Running/Completed/Failed)
- ìë™ ìŠ¤í¬ë¡¤ í† ê¸€
- ANSI ì½”ë“œ â†’ HTML ë³€í™˜ (`ansi-to-html`)
- íƒ€ì„ìŠ¤íƒ¬í”„ + ë¼ì¸ ìˆ˜ í‘œì‹œ

---

## 4. ë°ì´í„° íë¦„ ë‹¤ì´ì–´ê·¸ë¨

```mermaid
sequenceDiagram
    participant UI as Orders UI
    participant Card as OrderCard
    participant Modal as OrderModal
    participant Summary as OrderSummaryView
    participant Term as InteractiveTerminal
    participant IPC as IPC Handler
    participant Engine as BaristaEngineV2

    UI->>Card: ë Œë”ë§
    Card-->>UI: Status, Progress í‘œì‹œ
    
    User->>Card: í´ë¦­
    Card->>Modal: ì—´ê¸°
    Modal->>IPC: getOrderLog(orderId)
    IPC-->>Modal: íˆìŠ¤í† ë¦¬ ë¡œê·¸
    Modal->>IPC: order.subscribeOutput(orderId)
    
    loop ì‹¤í–‰ ì¤‘
        Engine-->>IPC: order:output ì´ë²¤íŠ¸
        IPC-->>Modal: ì‹¤ì‹œê°„ ì¶œë ¥
        Modal-->>Term: ì¶œë ¥ í‘œì‹œ
        
        Engine-->>IPC: order:stage-started
        IPC-->>Summary: Stage ìƒíƒœ ì—…ë°ì´íŠ¸
        
        Engine-->>IPC: order:stage-completed
        IPC-->>Summary: Stage ì™„ë£Œ í‘œì‹œ
    end
    
    alt ì‚¬ìš©ì ì…ë ¥ í•„ìš”
        Engine-->>IPC: await_user ì‹ í˜¸
        IPC-->>Summary: Awaiting Input UI í‘œì‹œ
        User->>Summary: ì…ë ¥ ì „ì†¡
        Summary->>IPC: order.sendInput(orderId, message)
        IPC->>Engine: ì…ë ¥ ì „ë‹¬
    end
    
    Engine-->>IPC: order:completed
    IPC-->>Modal: Order ì™„ë£Œ ìƒíƒœ
```

---

## 5. ì´ë²¤íŠ¸ íë¦„ ì •ë¦¬

### 5.1 IPC ì´ë²¤íŠ¸ (Main â†’ Renderer)

| ì´ë²¤íŠ¸ | ë°œìƒ ì‹œì  | í•¸ë“¤ëŸ¬ |
|--------|----------|--------|
| `order:output` | AI Provider ì¶œë ¥ ì‹œ | OrderModal, InteractiveTerminal |
| `order:stage-started` | Stage ì‹œì‘ ì‹œ | OrderDetailView |
| `order:stage-completed` | Stage ì™„ë£Œ ì‹œ | OrderDetailView |
| `order:completed` | Order ì™„ë£Œ ì‹œ | TerminalOutputPanel |
| `order:failed` | Order ì‹¤íŒ¨ ì‹œ | TerminalOutputPanel |

### 5.2 IPC API (Renderer â†’ Main)

| API | ìš©ë„ |
|-----|------|
| `order.get(orderId)` | Order ì •ë³´ ì¡°íšŒ |
| `order.execute(orderId)` | Order ì‹¤í–‰ |
| `order.cancel(orderId)` | Order ì·¨ì†Œ |
| `order.delete(orderId)` | Order ì‚­ì œ |
| `order.sendInput(orderId, message)` | ì‚¬ìš©ì ì…ë ¥ ì „ì†¡ |
| `order.subscribeOutput(orderId)` | ì¶œë ¥ ìŠ¤íŠ¸ë¦¼ êµ¬ë… |
| `order.unsubscribeOutput(orderId)` | ì¶œë ¥ ìŠ¤íŠ¸ë¦¼ êµ¬ë… í•´ì œ |
| `order.onOutput(callback)` | ì¶œë ¥ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ |
| `order.onStageStarted(callback)` | Stage ì‹œì‘ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ |
| `order.onStageCompleted(callback)` | Stage ì™„ë£Œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ |
| `order.getRetryOptions(orderId)` | ì¬ì‹œë„ ì˜µì…˜ ì¡°íšŒ |
| `order.retryFromStage(orderId, stageId)` | íŠ¹ì • Stageë¶€í„° ì¬ì‹œë„ |
| `order.retryFromBeginning(orderId, includeContext)` | ì²˜ìŒë¶€í„° ì¬ì‹œë„ |
| `getOrderLog(orderId)` | íˆìŠ¤í† ë¦¬ ë¡œê·¸ ì¡°íšŒ |

---

## 6. ê²°ë¡ 

`main-user-flow.md`ì— ì¶”ê°€ë˜ì–´ì•¼ í•  ë‚´ìš©:
1. **Order ì‹¤í–‰ UI ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°** (ì„¹ì…˜ 3 ì´í›„)
2. **Stage ì§„í–‰ ìƒí™© í‘œì‹œ UI** (OrderStageProgress)
3. **í„°ë¯¸ë„ ì¶œë ¥ í‘œì‹œ UI** (InteractiveTerminal, TerminalOutputPanel)
4. **ì‚¬ìš©ì ì…ë ¥ ì²˜ë¦¬ UI** (OrderSummaryViewì˜ Awaiting Input)
5. **Timeline ì´ë²¤íŠ¸ í‘œì‹œ** (OrderTimelineView)
6. **ì‹¤íŒ¨ ì‹œ ì¬ì‹œë„ UI** (OrderDetailViewì˜ Retry Options)
